# [AIè®­ç»ƒè¥]paddleclaså®ç°å›¾åƒåˆ†ç±»baseline

## 0 é¡¹ç›®èƒŒæ™¯
> [è¯¾ç¨‹é“¾æ¥ï¼šé£æ¡¨é¢†èˆªå›¢AIè¾¾äººåˆ›é€ è¥](https://aistudio.baidu.com/aistudio/course/introduce/24607?directly=1&shared=1)    


<center><font size="2px" color="red">ç™¾åº¦é£æ¡¨é¢†èˆªå›¢å…¨æ–°æ¨å‡ºâ€œAIè¾¾äººåˆ›é€ è¥â€</font></center>
<center><font color="black">è¯¥é¡¹ç›®ä¸»è¦ä¸ºå®ç°äº”ç§åœºæ™¯çš„åˆ†ç±»ï¼Œé€šè¿‡è¾“å…¥æŸä¸€åœºæ™¯çš„å›¾ç‰‡ä»è€Œè¯†åˆ«å‡ºç…§ç‰‡å±äºæŸä¸€ç‰¹å®šçš„åœºæ™¯æ‰‹æŠŠæ‰‹æ•™å¤§å®¶å®Œæˆé¡¹ç›®ä»ideaæ€è€ƒåˆ°éƒ¨ç½²è½åœ°çš„å…¨æµç¨‹å®æˆ˜</font></center>


## æœ¬å¤§ä½œä¸šä»»åŠ¡

1ã€é€‰æ‹©ä¸€ä¸ªå¿ƒä»ªçš„æ•°æ®é›†     
2ã€è¿è¡Œé¡¹ç›®ï¼Œ<font color="red">èƒ½å¤Ÿè·‘é€šé¡¹ç›®å³å¯è¾¾åˆ°ç»“ä¸šè¦æ±‚</font>     
3ã€è®°å¾—ç”Ÿæˆæ–°ç‰ˆæœ¬ï¼Œå…¬å¼€é¡¹ç›®å“¦~

**åŠ åˆ†é¡¹ï¼š**     
4ã€æ›´æ¢ç½‘ç»œã€è¿›è¡Œæ•°æ®é¢„å¤„ç†å’Œè°ƒå‚   

## 1 é¡¹ç›®å®ç°ç®€ä»‹
æ­£å¦‚æ ‡é¢˜ï¼Œé‡‡ç”¨paddleclaså¥—ä»¶å®ç°åˆ†ç±»[30åˆ†é’Ÿç©è½¬PaddleClasï¼ˆå°é²œç‰ˆï¼‰](https://gitee.com/paddlepaddle/PaddleClas/blob/release/2.2/docs/zh_CN/tutorials/quick_start_new_user.md)    
æŸ¥çœ‹å¥—ä»¶ï¼Œå¯ä»¥çŸ¥é“    
å®ç°åˆ†ç±»ï¼Œä»…ä»…éœ€è¦æˆ‘ä»¬å°†æ•°æ®é›†æå–ä¸ºå¦‚ä¸‹è¿™ç§æ ¼å¼çš„txtæ–‡ä»¶å³å¯ï¼ˆå½“ç„¶æˆ‘ä»¬å¹¶ä¸éœ€è¦æ›´å¤§çš„è®­ç»ƒé›†ï¼‰    
![](https://ai-studio-static-online.cdn.bcebos.com/012e5e2e7a204f77ab2ad9759860978d6b19d55946dd4ee2adea6a4e9736d121)

PSï¼š
å¦‚æœ‰éœ€è¦å‚è€ƒé¡¹ç›®å¯çœ‹ï¼š      
[åŸºäºPaddleClas2.2çš„ä»é›¶åˆ°è½åœ°å®‰å“éƒ¨ç½²çš„å¥¥ç‰¹æ›¼åˆ†ç±»å®æˆ˜](https://aistudio.baidu.com/aistudio/projectdetail/2219455)
[iFLYTEKåŸºäºPaddleClas2.2çš„å¹¿å‘Šåˆ†ç±»baselineéå®˜æ–¹](https://aistudio.baidu.com/aistudio/projectdetail/2235340)


## 2 æ•°æ®é›†ä»‹ç»

<font size="3px" color="red">æœ¬æ¬¡æ•°æ®é›†æœ‰äº”ä¸ªå¯ä¾›å¤§å®¶é€‰æ‹©ã€‚åˆ†åˆ«æ˜¯ï¼š</font>   
1. çŒ«12åˆ†ç±»
2. åƒåœ¾40åˆ†ç±»
3. åœºæ™¯5åˆ†ç±»
4. é£Ÿç‰©5åˆ†ç±»
5. è´è¶20åˆ†ç±»

**æ•°æ®é›†ï¼šéƒ½æ˜¯ä¸åŒç±»åˆ«çš„æ–‡ä»¶å¤¹ä¸‹æ”¾ç½®äº†å¯¹åº”æ–‡ä»¶å¤¹åå­—çš„ç±»åˆ«å›¾ç‰‡**



```python
# å…ˆå¯¼å…¥åº“
from sklearn.utils import shuffle
import os
import pandas as pd
import numpy as np
from PIL import Image
import paddle
import paddle.nn as nn
import random
```


```python
# å¿½ç•¥ï¼ˆåƒåœ¾ï¼‰è­¦å‘Šä¿¡æ¯
# åœ¨pythonä¸­è¿è¡Œä»£ç ç»å¸¸ä¼šé‡åˆ°çš„æƒ…å†µæ˜¯â€”â€”ä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œä½†æ˜¯ä¼šæç¤ºè­¦å‘Šï¼Œæœ‰æ—¶ç‰¹åˆ«è®¨åŒã€‚
# é‚£ä¹ˆå¦‚ä½•æ¥æ§åˆ¶è­¦å‘Šè¾“å‡ºå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œpythoné€šè¿‡è°ƒç”¨warningsæ¨¡å—ä¸­å®šä¹‰çš„warn()å‡½æ•°æ¥å‘å‡ºè­¦å‘Šã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è­¦å‘Šè¿‡æ»¤å™¨è¿›è¡Œæ§åˆ¶æ˜¯å¦å‘å‡ºè­¦å‘Šæ¶ˆæ¯ã€‚
import warnings
warnings.filterwarnings("ignore")
```

### 2.1 è§£å‹æ•°æ®é›†ï¼ŒæŸ¥çœ‹æ•°æ®çš„ç»“æ„


```python
# é¡¹ç›®æŒ‚è½½çš„æ•°æ®é›†å…ˆè§£å‹å‡ºæ¥ï¼Œå¾…è§£å‹å®Œæ¯•ï¼Œåˆ·æ–°åå¯å‘ç°å·¦ä¾§æ–‡ä»¶å¤¹æ ¹ç›®å½•å‡ºç°äº”ä¸ªzip
!unzip -oq /home/aistudio/data/data103736/äº”ç§å›¾åƒåˆ†ç±»æ•°æ®é›†.zip
```

å·¦ä¾§å¯ä»¥çœ‹åˆ°å¦‚å›¾æ‰€ç¤ºäº”ä¸ªzip    
![](https://ai-studio-static-online.cdn.bcebos.com/f8bc5b21a0ba49b4b78b6e7b18ac0341dfb14cf545b14c83b1f597b6ee8109bb)



```python
# æœ¬é¡¹ç›®ä»¥é£Ÿç‰©åˆ†ç±»ä¸ºä¾‹è¿›è¡Œä»‹ç»ï¼Œå› ä¸ºåˆ†ç±»å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ä¸å­˜åœ¨æ ‡ç­¾æ–‡ä»¶çš„ï¼ŒçŒ«åˆ†ç±»å·²ç»æœ‰äº†æ ‡ç­¾ï¼Œçœå»äº†æ•°æ®å¤„ç†çš„æ“ä½œ
# (æ­¤å¤„éœ€è¦ä½ æ ¹æ®è‡ªå·±çš„é€‰æ‹©è¿›è¡Œè§£å‹å¯¹åº”çš„æ–‡ä»¶)
# è§£å‹å®Œæ¯•å·¦ä¾§å‡ºç°æ–‡ä»¶å¤¹ï¼Œå³ä¸ºéœ€è¦åˆ†ç±»çš„æ–‡ä»¶
!unzip -oq /home/aistudio/åœºæ™¯5åˆ†ç±».zip
```


```python
# æŸ¥çœ‹ç»“æ„ï¼Œæ­£ä¸ºä¸€ä¸ªç±»åˆ«ä¸‹æœ‰ä¸€ç³»åˆ—å¯¹åº”çš„å›¾ç‰‡
!tree scenes/
```

    5 directories, 3498 files

**äº”ç±»é£Ÿç‰©å›¾ç‰‡**  
1. beef_carpaccio
2. baby_back_ribs
3. beef_tartare
4. apple_pie
5. baklava    

å…·ä½“ç»“æ„å¦‚ä¸‹ï¼š
```
foods/
â”œâ”€â”€ apple_pie
â”‚   â”œâ”€â”€ 1005649.jpg
â”‚   â”œâ”€â”€ 1011328.jpg
â”‚   â”œâ”€â”€ 101251.jpg
```

### 2.2 æ‹¿åˆ°æ€»çš„è®­ç»ƒæ•°æ®txt


```python
import os
# -*- coding: utf-8 -*-
# æ ¹æ®å®˜æ–¹paddleclasçš„æç¤ºï¼Œæˆ‘ä»¬éœ€è¦æŠŠå›¾åƒå˜ä¸ºä¸¤ä¸ªtxtæ–‡ä»¶
# train_list.txtï¼ˆè®­ç»ƒé›†ï¼‰
# val_list.txtï¼ˆéªŒè¯é›†ï¼‰
# å…ˆæŠŠè·¯å¾„æå®š æ¯”å¦‚ï¼šfoods/beef_carpaccio/855780.jpg ,è¯»å–åˆ°å¹¶å†™å…¥txt 

# æ ¹æ®å·¦ä¾§ç”Ÿæˆçš„æ–‡ä»¶å¤¹åå­—æ¥å†™æ ¹ç›®å½•
dirpath = "scenes"
# å…ˆå¾—åˆ°æ€»çš„txtåç»­å†è¿›è¡Œåˆ’åˆ†ï¼Œå› ä¸ºè¦åˆ’åˆ†å‡ºéªŒè¯é›†ï¼Œæ‰€ä»¥è¦å…ˆæ‰“ä¹±ï¼Œå› ä¸ºåŸæœ¬æ˜¯æœ‰åºçš„
def get_all_txt():
    all_list = []
    i = 0 # æ ‡è®°æ€»æ–‡ä»¶æ•°é‡
    j = 0 # æ ‡è®°æ–‡ä»¶ç±»åˆ«
    for root,dirs,files in os.walk(dirpath): # åˆ†åˆ«ä»£è¡¨æ ¹ç›®å½•ã€æ–‡ä»¶å¤¹ã€æ–‡ä»¶
        for file in files:
            i = i + 1 
            # æ–‡ä»¶ä¸­æ¯è¡Œæ ¼å¼ï¼š å›¾åƒç›¸å¯¹è·¯å¾„      å›¾åƒçš„label_idï¼ˆæ•°å­—ç±»åˆ«ï¼‰ï¼ˆæ³¨æ„ï¼šä¸­é—´æœ‰ç©ºæ ¼ï¼‰ã€‚              
            imgpath = os.path.join(root,file)
            all_list.append(imgpath+" "+str(j)+"\n")

        j = j + 1

    allstr = ''.join(all_list)
    f = open('all_list.txt','w',encoding='utf-8')
    f.write(allstr)
    return all_list , i
all_list,all_lenth = get_all_txt()
print(all_lenth)
```

    3499


### 2.3 æ•°æ®æ‰“ä¹±


```python
# æŠŠæ•°æ®æ‰“ä¹±
all_list = shuffle(all_list)
allstr = ''.join(all_list)
f = open('all_list.txt','w',encoding='utf-8')
f.write(allstr)
print("æ‰“ä¹±æˆåŠŸï¼Œå¹¶é‡æ–°å†™å…¥æ–‡æœ¬")
```

    æ‰“ä¹±æˆåŠŸï¼Œå¹¶é‡æ–°å†™å…¥æ–‡æœ¬


### 2.4 æ•°æ®åˆ’åˆ†


```python
# æŒ‰ç…§æ¯”ä¾‹åˆ’åˆ†æ•°æ®é›† é£Ÿå“çš„æ•°æ®æœ‰5000å¼ å›¾ç‰‡ï¼Œä¸ç®—å¤§æ•°æ®ï¼Œä¸€èˆ¬9:1å³å¯
train_size = int(all_lenth * 0.9)
train_list = all_list[:train_size]
val_list = all_list[train_size:]

print(len(train_list))
print(len(val_list))
```

    3149
    350



```python
# è¿è¡Œcellï¼Œç”Ÿæˆè®­ç»ƒé›†txt 
train_txt = ''.join(train_list)
f_train = open('train_list.txt','w',encoding='utf-8')
f_train.write(train_txt)
f_train.close()
print("train_list.txt ç”ŸæˆæˆåŠŸï¼")

# è¿è¡Œcellï¼Œç”ŸæˆéªŒè¯é›†txt
val_txt = ''.join(val_list)
f_val = open('val_list.txt','w',encoding='utf-8')
f_val.write(val_txt)
f_val.close()
print("val_list.txt ç”ŸæˆæˆåŠŸï¼")
```

    train_list.txt ç”ŸæˆæˆåŠŸï¼
    val_list.txt ç”ŸæˆæˆåŠŸï¼


## 3 å®‰è£…paddleclas

æ•°æ®é›†æ ¸å®å®Œæå®šæˆåŠŸçš„å‰æä¸‹ï¼Œå¯ä»¥å‡†å¤‡æ›´æ”¹åŸæ–‡æ¡£çš„å‚æ•°è¿›è¡Œå®ç°è‡ªå·±çš„å›¾ç‰‡åˆ†ç±»äº†ï¼

è¿™é‡Œé‡‡ç”¨paddleclasçš„2.2ç‰ˆæœ¬ï¼Œå¥½ç”¨ï¼


```python
# å…ˆæŠŠpaddleclaså®‰è£…ä¸Šå†è¯´
# å®‰è£…paddleclasä»¥åŠç›¸å…³ä¸‰æ–¹åŒ…(å¥½åƒstudioè‡ªå¸¦çš„å·²ç»å¤Ÿç”¨äº†ï¼Œæ— éœ€å®‰è£…äº†)
!git clone https://gitee.com/paddlepaddle/PaddleClas.git -b release/2.2
# æˆ‘è¿™é‡Œå®‰è£…ç›¸å…³åŒ…æ—¶ï¼ŒèŠ±äº†30å‡ åˆ†é’Ÿè¿˜æœ‰é”™è¯¯æç¤ºï¼Œä¸ç®¡ä»–å³å¯
#!pip install --upgrade -r PaddleClas/requirements.txt -i https://mirror.baidu.com/pypi/simple
```

    Cloning into 'PaddleClas'...
    remote: Enumerating objects: 538, done.[K
    remote: Counting objects: 100% (538/538), done.[K
    remote: Compressing objects: 100% (323/323), done.[K
    remote: Total 15290 (delta 347), reused 349 (delta 210), pack-reused 14752[K
    Receiving objects: 100% (15290/15290), 113.56 MiB | 6.55 MiB/s, done.
    Resolving deltas: 100% (10239/10239), done.
    Checking connectivity... done.



```python
#å› ä¸ºåç»­paddleclasçš„å‘½ä»¤éœ€è¦åœ¨PaddleClasç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¿›å…¥PaddleClasæ ¹ç›®å½•ï¼Œæ‰§è¡Œæ­¤å‘½ä»¤
%cd PaddleClas
!ls
```

    /home/aistudio/PaddleClas
    dataset  hubconf.py   MANIFEST.in    README_ch.md  requirements.txt
    deploy	 __init__.py  paddleclas.py  README_en.md  setup.py
    docs	 LICENSE      ppcls	     README.md	   tools



```python
# å°†å›¾ç‰‡ç§»åŠ¨åˆ°paddleclasä¸‹é¢çš„æ•°æ®é›†é‡Œé¢
# è‡³äºä¸ºä»€ä¹ˆç°åœ¨ç§»åŠ¨ï¼Œä¹Ÿæ˜¯æˆ‘çš„ä¸€ç‚¹å°æŠ€å·§ï¼Œé˜²æ­¢ä¹‹å‰ç§»åŠ¨çš„è¯ï¼Œç”Ÿæˆçš„txtçš„è·¯å¾„æ˜¯å…¨è·¯å¾„ï¼Œåè€Œéœ€è¦å»æ‰è·¯å¾„çš„ä¸€éƒ¨åˆ†
!mv ../scenes/ dataset/
```


```python
# æŒªåŠ¨æ–‡ä»¶åˆ°å¯¹åº”ç›®å½•
!mv ../all_list.txt dataset/scenes
!mv ../train_list.txt dataset/scenes
!mv ../val_list.txt dataset/scenes
```

### 3.1 ä¿®æ”¹é…ç½®æ–‡ä»¶
#### 3.1.1
ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹ï¼šåˆ†ç±»æ•°ã€å›¾ç‰‡æ€»é‡ã€è®­ç»ƒå’ŒéªŒè¯çš„è·¯å¾„ã€å›¾åƒå°ºå¯¸ã€æ•°æ®é¢„å¤„ç†ã€è®­ç»ƒå’Œé¢„æµ‹çš„num_workers: 0

è·¯å¾„å¦‚ä¸‹ï¼š
>PaddleClas/ppcls/configs/quick_start/new_user/ShuffleNetV2_x0_25.yaml

<font size="3px" color="red">ï¼ˆä¸»è¦çš„å‚æ•°å·²ç»è¿›è¡Œæ³¨é‡Šï¼Œä¸€å®šè¦è¿‡ä¸€éï¼‰</font>

```
# global configs
Global:
  checkpoints: null
  pretrained_model: null
  output_dir: ./output/
  # ä½¿ç”¨GPUè®­ç»ƒ
  device: gpu
  # æ¯å‡ ä¸ªè½®æ¬¡ä¿å­˜ä¸€æ¬¡
  save_interval: 1 
  eval_during_train: True
  # æ¯å‡ ä¸ªè½®æ¬¡éªŒè¯ä¸€æ¬¡
  eval_interval: 1 
  # è®­ç»ƒè½®æ¬¡
  epochs: 20 
  print_batch_step: 1
  use_visualdl: True #å¼€å¯å¯è§†åŒ–ï¼ˆç›®å‰å¹³å°ä¸å¯ç”¨ï¼‰
  # used for static mode and model export
  # å›¾åƒå¤§å°
  image_shape: [3, 224, 224] 
  save_inference_dir: ./inference
  # training model under @to_static
  to_static: False

# model architecture
Arch:
  # é‡‡ç”¨çš„ç½‘ç»œ
  name: ResNet50
  # ç±»åˆ«æ•° å¤šäº†ä¸ª0ç±» 0-5 0æ— ç”¨ 
  class_num: 6 
 
# loss function config for traing/eval process
Loss:
  Train:

    - CELoss: 
        weight: 1.0
  Eval:
    - CELoss:
        weight: 1.0


Optimizer:
  name: Momentum
  momentum: 0.9
  lr:
    name: Piecewise
    learning_rate: 0.015
    decay_epochs: [30, 60, 90]
    values: [0.1, 0.01, 0.001, 0.0001]
  regularizer:
    name: 'L2'
    coeff: 0.0005


# data loader for train and eval
DataLoader:
  Train:
    dataset:
      name: ImageNetDataset
      # æ ¹è·¯å¾„
      image_root: ./dataset/
      # å‰é¢è‡ªå·±ç”Ÿäº§å¾—åˆ°çš„è®­ç»ƒé›†æ–‡æœ¬è·¯å¾„
      cls_label_path: ./dataset/foods/train_list.txt
      # æ•°æ®é¢„å¤„ç†
      transform_ops:
        - DecodeImage:
            to_rgb: True
            channel_first: False
        - ResizeImage:
            resize_short: 256
        - CropImage:
            size: 224
        - RandFlipImage:
            flip_code: 1
        - NormalizeImage:
            scale: 1.0/255.0
            mean: [0.485, 0.456, 0.406]
            std: [0.229, 0.224, 0.225]
            order: ''

    sampler:
      name: DistributedBatchSampler
      batch_size: 128
      drop_last: False
      shuffle: True
    loader:
      num_workers: 0
      use_shared_memory: True

  Eval:
    dataset: 
      name: ImageNetDataset
      # æ ¹è·¯å¾„
      image_root: ./dataset/
      # å‰é¢è‡ªå·±ç”Ÿäº§å¾—åˆ°çš„éªŒè¯é›†æ–‡æœ¬è·¯å¾„
      cls_label_path: ./dataset/foods/val_list.txt
      # æ•°æ®é¢„å¤„ç†
      transform_ops:
        - DecodeImage:
            to_rgb: True
            channel_first: False
        - ResizeImage:
            resize_short: 256
        - CropImage:
            size: 224
        - NormalizeImage:
            scale: 1.0/255.0
            mean: [0.485, 0.456, 0.406]
            std: [0.229, 0.224, 0.225]
            order: ''
    sampler:
      name: DistributedBatchSampler
      batch_size: 128
      drop_last: False
      shuffle: True
    loader:
      num_workers: 0
      use_shared_memory: True

Infer:
  infer_imgs: ./dataset/foods/beef_carpaccio/855780.jpg
  batch_size: 10
  transforms:
    - DecodeImage:
        to_rgb: True
        channel_first: False
    - ResizeImage:
        resize_short: 256
    - CropImage:
        size: 224
    - NormalizeImage:
        scale: 1.0/255.0
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
        order: ''
    - ToCHWImage:
  PostProcess:
    name: Topk
    # è¾“å‡ºçš„å¯èƒ½æ€§æœ€é«˜çš„å‰topkä¸ª
    topk: 5
    # æ ‡ç­¾æ–‡ä»¶ éœ€è¦è‡ªå·±æ–°å»ºæ–‡ä»¶
    class_id_map_file: ./dataset/label_list.txt

Metric:
  Train:
    - TopkAcc:
        topk: [1, 5]
  Eval:
    - TopkAcc:
        topk: [1, 5]
```
#### 3.1.2 æ ‡ç­¾æ–‡ä»¶
è¿™ä¸ªæ˜¯åœ¨é¢„æµ‹æ—¶ç”Ÿæˆå¯¹ç…§çš„ä¾æ®ï¼Œåœ¨ä¸Šä¸ªæ–‡ä»¶æœ‰æåˆ°è¿™ä¸ª
```
# æ ‡ç­¾æ–‡ä»¶ éœ€è¦è‡ªå·±æ–°å»ºæ–‡ä»¶
    class_id_map_file: dataset/label_list.txt
```
æŒ‰ç…§å¯¹åº”çš„è¿›è¡Œç¼–å†™ï¼š   

![](https://ai-studio-static-online.cdn.bcebos.com/0e40a0afaa824ba9b70778aa7931a3baf2a421bcb81b4b0f83632da4e4ddc0ef)  

å¦‚é£Ÿå“åˆ†ç±»(è¦å¯¹ç…§ä¹‹å‰çš„txtçš„ç±»åˆ«ç¡®è®¤æ— è¯¯) 
```
1 beef_carpaccio
2 baby_back_ribs
3 beef_tartare
4 apple_pie
5 baklava
```
![](https://ai-studio-static-online.cdn.bcebos.com/6b3a4a244ed34517bcf4be5fcc629ab10d081eb0af7c4532a795583d19939a82)




![](https://ai-studio-static-online.cdn.bcebos.com/8ee69dbad8bf4e0f9c743645a4438cc035446d052d4b409a88c1cc25b58dcf83)

### 3.2 å¼€å§‹è®­ç»ƒ


```python
# æç¤ºï¼Œè¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å­˜åœ¨åå›¾çš„æƒ…å†µï¼Œä½†æ˜¯ä¸ç”¨æ‹…å¿ƒï¼Œè®­ç»ƒè¿‡ç¨‹ä¸å—å½±å“ã€‚
# ä»…ä¾›å‚è€ƒï¼Œæˆ‘åªè·‘äº†äº”è½®ï¼Œå‡†ç¡®ç‡å¾ˆä½
!python3 tools/train.py \
    -c ./ppcls/configs/quick_start/new_user/ShuffleNetV2_x0_25.yaml
```

    /home/aistudio/PaddleClas/ppcls/arch/backbone/model_zoo/vision_transformer.py:15: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Callable
    [2021/08/13 17:58:55] root INFO: 
    ===========================================================
    ==        PaddleClas is powered by PaddlePaddle !        ==
    ===========================================================
    ==                                                       ==
    ==   For more info please go to the following website.   ==
    ==                                                       ==
    ==       https://github.com/PaddlePaddle/PaddleClas      ==
    ===========================================================
    
    [2021/08/13 17:58:55] root INFO: Arch : 
    [2021/08/13 17:58:55] root INFO:     class_num : 102
    [2021/08/13 17:58:55] root INFO:     name : ShuffleNetV2_x0_25
    [2021/08/13 17:58:55] root INFO: DataLoader : 
    [2021/08/13 17:58:55] root INFO:     Eval : 
    [2021/08/13 17:58:55] root INFO:         dataset : 
    [2021/08/13 17:58:55] root INFO:             cls_label_path : ./dataset/scenes/val_list.txt
    [2021/08/13 17:58:55] root INFO:             image_root : ./dataset/
    [2021/08/13 17:58:55] root INFO:             name : ImageNetDataset
    [2021/08/13 17:58:55] root INFO:             transform_ops : 
    [2021/08/13 17:58:55] root INFO:                 DecodeImage : 
    [2021/08/13 17:58:55] root INFO:                     channel_first : False
    [2021/08/13 17:58:55] root INFO:                     to_rgb : True
    [2021/08/13 17:58:55] root INFO:                 ResizeImage : 
    [2021/08/13 17:58:55] root INFO:                     resize_short : 256
    [2021/08/13 17:58:55] root INFO:                 CropImage : 
    [2021/08/13 17:58:55] root INFO:                     size : 224
    [2021/08/13 17:58:55] root INFO:                 NormalizeImage : 
    [2021/08/13 17:58:55] root INFO:                     mean : [0.485, 0.456, 0.406]
    [2021/08/13 17:58:55] root INFO:                     order : 
    [2021/08/13 17:58:55] root INFO:                     scale : 1.0/255.0
    [2021/08/13 17:58:55] root INFO:                     std : [0.229, 0.224, 0.225]
    [2021/08/13 17:58:55] root INFO:         loader : 
    [2021/08/13 17:58:55] root INFO:             num_workers : 4
    [2021/08/13 17:58:55] root INFO:             use_shared_memory : False
    [2021/08/13 17:58:55] root INFO:         sampler : 
    [2021/08/13 17:58:55] root INFO:             batch_size : 64
    [2021/08/13 17:58:55] root INFO:             drop_last : False
    [2021/08/13 17:58:55] root INFO:             name : DistributedBatchSampler
    [2021/08/13 17:58:55] root INFO:             shuffle : False
    [2021/08/13 17:58:55] root INFO:     Train : 
    [2021/08/13 17:58:55] root INFO:         dataset : 
    [2021/08/13 17:58:55] root INFO:             cls_label_path : ./dataset/scenes/train_list.txt
    [2021/08/13 17:58:55] root INFO:             image_root : ./dataset/
    [2021/08/13 17:58:55] root INFO:             name : ImageNetDataset
    [2021/08/13 17:58:55] root INFO:             transform_ops : 
    [2021/08/13 17:58:55] root INFO:                 DecodeImage : 
    [2021/08/13 17:58:55] root INFO:                     channel_first : False
    [2021/08/13 17:58:55] root INFO:                     to_rgb : True
    [2021/08/13 17:58:55] root INFO:                 RandCropImage : 
    [2021/08/13 17:58:55] root INFO:                     size : 224
    [2021/08/13 17:58:55] root INFO:                 RandFlipImage : 
    [2021/08/13 17:58:55] root INFO:                     flip_code : 1
    [2021/08/13 17:58:55] root INFO:                 NormalizeImage : 
    [2021/08/13 17:58:55] root INFO:                     mean : [0.485, 0.456, 0.406]
    [2021/08/13 17:58:55] root INFO:                     order : 
    [2021/08/13 17:58:55] root INFO:                     scale : 1.0/255.0
    [2021/08/13 17:58:55] root INFO:                     std : [0.229, 0.224, 0.225]
    [2021/08/13 17:58:55] root INFO:         loader : 
    [2021/08/13 17:58:55] root INFO:             num_workers : 4
    [2021/08/13 17:58:55] root INFO:             use_shared_memory : False
    [2021/08/13 17:58:55] root INFO:         sampler : 
    [2021/08/13 17:58:55] root INFO:             batch_size : 256
    [2021/08/13 17:58:55] root INFO:             drop_last : False
    [2021/08/13 17:58:55] root INFO:             name : DistributedBatchSampler
    [2021/08/13 17:58:55] root INFO:             shuffle : True
    [2021/08/13 17:58:55] root INFO: Global : 
    [2021/08/13 17:58:55] root INFO:     checkpoints : None
    [2021/08/13 17:58:55] root INFO:     device : cpu
    [2021/08/13 17:58:55] root INFO:     epochs : 20
    [2021/08/13 17:58:55] root INFO:     eval_during_train : True
    [2021/08/13 17:58:55] root INFO:     eval_interval : 1
    [2021/08/13 17:58:55] root INFO:     image_shape : [3, 224, 224]
    [2021/08/13 17:58:55] root INFO:     output_dir : ./output/
    [2021/08/13 17:58:55] root INFO:     pretrained_model : None
    [2021/08/13 17:58:55] root INFO:     print_batch_step : 10
    [2021/08/13 17:58:55] root INFO:     save_inference_dir : ./inference
    [2021/08/13 17:58:55] root INFO:     save_interval : 1
    [2021/08/13 17:58:55] root INFO:     use_visualdl : False
    [2021/08/13 17:58:55] root INFO: Infer : 
    [2021/08/13 17:58:55] root INFO:     PostProcess : 
    [2021/08/13 17:58:55] root INFO:         class_id_map_file : ./dataset/label_list.txt
    [2021/08/13 17:58:55] root INFO:         name : Topk
    [2021/08/13 17:58:55] root INFO:         topk : 5
    [2021/08/13 17:58:55] root INFO:     batch_size : 10
    [2021/08/13 17:58:55] root INFO:     infer_imgs : docs/images/whl/river.jpg
    [2021/08/13 17:58:55] root INFO:     transforms : 
    [2021/08/13 17:58:55] root INFO:         DecodeImage : 
    [2021/08/13 17:58:55] root INFO:             channel_first : False
    [2021/08/13 17:58:55] root INFO:             to_rgb : True
    [2021/08/13 17:58:55] root INFO:         ResizeImage : 
    [2021/08/13 17:58:55] root INFO:             resize_short : 256
    [2021/08/13 17:58:55] root INFO:         CropImage : 
    [2021/08/13 17:58:55] root INFO:             size : 224
    [2021/08/13 17:58:55] root INFO:         NormalizeImage : 
    [2021/08/13 17:58:55] root INFO:             mean : [0.485, 0.456, 0.406]
    [2021/08/13 17:58:55] root INFO:             order : 
    [2021/08/13 17:58:55] root INFO:             scale : 1.0/255.0
    [2021/08/13 17:58:55] root INFO:             std : [0.229, 0.224, 0.225]
    [2021/08/13 17:58:55] root INFO:         ToCHWImage : None
    [2021/08/13 17:58:55] root INFO: Loss : 
    [2021/08/13 17:58:55] root INFO:     Eval : 
    [2021/08/13 17:58:55] root INFO:         CELoss : 
    [2021/08/13 17:58:55] root INFO:             weight : 1.0
    [2021/08/13 17:58:55] root INFO:     Train : 
    [2021/08/13 17:58:55] root INFO:         CELoss : 
    [2021/08/13 17:58:55] root INFO:             weight : 1.0
    [2021/08/13 17:58:55] root INFO: Metric : 
    [2021/08/13 17:58:55] root INFO:     Eval : 
    [2021/08/13 17:58:55] root INFO:         TopkAcc : 
    [2021/08/13 17:58:55] root INFO:             topk : [1, 5]
    [2021/08/13 17:58:55] root INFO:     Train : 
    [2021/08/13 17:58:55] root INFO:         TopkAcc : 
    [2021/08/13 17:58:55] root INFO:             topk : [1, 5]
    [2021/08/13 17:58:55] root INFO: Optimizer : 
    [2021/08/13 17:58:55] root INFO:     lr : 
    [2021/08/13 17:58:55] root INFO:         learning_rate : 0.0125
    [2021/08/13 17:58:55] root INFO:         name : Cosine
    [2021/08/13 17:58:55] root INFO:         warmup_epoch : 5
    [2021/08/13 17:58:55] root INFO:     momentum : 0.9
    [2021/08/13 17:58:55] root INFO:     name : Momentum
    [2021/08/13 17:58:55] root INFO:     regularizer : 
    [2021/08/13 17:58:55] root INFO:         coeff : 1e-05
    [2021/08/13 17:58:55] root INFO:         name : L2
    [2021/08/13 17:58:55] root INFO: train with paddle 2.1.2 and device CPUPlace
    {'CELoss': {'weight': 1.0}}
    [2021/08/13 17:58:57] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 17:59:09] root INFO: [Train][Epoch 1/20][Iter: 0/13]lr: 0.00019, CELoss: 4.93127, loss: 4.93127, top1: 0.00000, top5: 0.00000, batch_cost: 13.55308s, reader_cost: 3.93561, ips: 18.88870 images/sec, eta: 0:58:43
    [2021/08/13 17:59:58] root INFO: [Train][Epoch 1/20][Iter: 10/13]lr: 0.00212, CELoss: 4.69671, loss: 4.69671, top1: 0.00071, top5: 0.04936, batch_cost: 4.82175s, reader_cost: 0.00018, ips: 53.09274 images/sec, eta: 0:20:05
    [2021/08/13 18:00:04] root INFO: [Train][Epoch 1/20][Avg]CELoss: 4.61774, loss: 4.61774, top1: 0.00889, top5: 0.09654
    {'CELoss': {'weight': 1.0}}
    [2021/08/13 18:00:07] root INFO: [Eval][Epoch 1][Iter: 0/6]CELoss: 4.03180, loss: 4.03180, top1: 0.23438, top5: 0.60938, batch_cost: 2.93409s, reader_cost: 2.00264, ips: 21.81252 images/sec
    [2021/08/13 18:00:09] root INFO: [Eval][Epoch 1][Avg]CELoss: 4.03626, loss: 4.03626, top1: 0.21143, top5: 0.63714
    [2021/08/13 18:00:09] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:00:09] root INFO: [Eval][Epoch 1][best metric: 0.21142857245036534]
    [2021/08/13 18:00:09] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_1
    [2021/08/13 18:00:09] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:00:13] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:00:25] root INFO: [Train][Epoch 2/20][Iter: 0/13]lr: 0.00269, CELoss: 3.59768, loss: 3.59768, top1: 0.19922, top5: 0.59375, batch_cost: 6.21248s, reader_cost: 1.21268, ips: 41.20739 images/sec, eta: 0:25:34
    [2021/08/13 18:01:12] root INFO: [Train][Epoch 2/20][Iter: 10/13]lr: 0.00462, CELoss: 2.47854, loss: 2.47854, top1: 0.22621, top5: 0.93217, batch_cost: 4.74710s, reader_cost: 0.00019, ips: 53.92763 images/sec, eta: 0:18:45
    [2021/08/13 18:01:19] root INFO: [Train][Epoch 2/20][Avg]CELoss: 2.40147, loss: 2.40147, top1: 0.22960, top5: 0.93935
    [2021/08/13 18:01:22] root INFO: [Eval][Epoch 2][Iter: 0/6]CELoss: 1.72458, loss: 1.72458, top1: 0.29688, top5: 1.00000, batch_cost: 2.82327s, reader_cost: 1.88541, ips: 22.66878 images/sec
    [2021/08/13 18:01:24] root INFO: [Eval][Epoch 2][Avg]CELoss: 1.78789, loss: 1.78789, top1: 0.25429, top5: 1.00000
    [2021/08/13 18:01:24] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:01:24] root INFO: [Eval][Epoch 2][best metric: 0.2542857148817607]
    [2021/08/13 18:01:24] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_2
    [2021/08/13 18:01:24] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:01:25] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:01:40] root INFO: [Train][Epoch 3/20][Iter: 0/13]lr: 0.00519, CELoss: 1.66659, loss: 1.66659, top1: 0.26172, top5: 1.00000, batch_cost: 6.18428s, reader_cost: 1.19442, ips: 41.39526 images/sec, eta: 0:24:07
    [2021/08/13 18:02:28] root INFO: [Train][Epoch 3/20][Iter: 10/13]lr: 0.00712, CELoss: 1.61231, loss: 1.61231, top1: 0.27557, top5: 1.00000, batch_cost: 4.83563s, reader_cost: 0.00019, ips: 52.94036 images/sec, eta: 0:18:03
    [2021/08/13 18:02:35] root INFO: [Train][Epoch 3/20][Avg]CELoss: 1.60796, loss: 1.60796, top1: 0.27596, top5: 1.00000
    [2021/08/13 18:02:38] root INFO: [Eval][Epoch 3][Iter: 0/6]CELoss: 1.57696, loss: 1.57696, top1: 0.21875, top5: 1.00000, batch_cost: 2.85465s, reader_cost: 1.90066, ips: 22.41958 images/sec
    [2021/08/13 18:02:40] root INFO: [Eval][Epoch 3][Avg]CELoss: 1.58151, loss: 1.58151, top1: 0.25714, top5: 1.00000
    [2021/08/13 18:02:40] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:02:40] root INFO: [Eval][Epoch 3][best metric: 0.2571428572280066]
    [2021/08/13 18:02:40] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_3
    [2021/08/13 18:02:40] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:02:55] root INFO: [Train][Epoch 4/20][Iter: 0/13]lr: 0.00769, CELoss: 1.55500, loss: 1.55500, top1: 0.30078, top5: 1.00000, batch_cost: 6.21177s, reader_cost: 0.97976, ips: 41.21210 images/sec, eta: 0:22:52
    [2021/08/13 18:03:00] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:03:43] root INFO: [Train][Epoch 4/20][Iter: 10/13]lr: 0.00962, CELoss: 1.54626, loss: 1.54626, top1: 0.30504, top5: 1.00000, batch_cost: 4.80615s, reader_cost: 0.00019, ips: 53.26506 images/sec, eta: 0:16:54
    [2021/08/13 18:03:50] root INFO: [Train][Epoch 4/20][Avg]CELoss: 1.54413, loss: 1.54413, top1: 0.30454, top5: 1.00000
    [2021/08/13 18:03:53] root INFO: [Eval][Epoch 4][Iter: 0/6]CELoss: 1.50143, loss: 1.50143, top1: 0.37500, top5: 1.00000, batch_cost: 2.87785s, reader_cost: 1.91817, ips: 22.23881 images/sec
    [2021/08/13 18:03:55] root INFO: [Eval][Epoch 4][Avg]CELoss: 1.54009, loss: 1.54009, top1: 0.30571, top5: 1.00000
    [2021/08/13 18:03:55] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:03:55] root INFO: [Eval][Epoch 4][best metric: 0.30571428656578065]
    [2021/08/13 18:03:55] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_4
    [2021/08/13 18:03:55] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:03:58] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:04:10] root INFO: [Train][Epoch 5/20][Iter: 0/13]lr: 0.01019, CELoss: 1.51848, loss: 1.51848, top1: 0.35547, top5: 1.00000, batch_cost: 6.21175s, reader_cost: 0.98354, ips: 41.21221 images/sec, eta: 0:21:32
    [2021/08/13 18:04:59] root INFO: [Train][Epoch 5/20][Iter: 10/13]lr: 0.01212, CELoss: 1.50400, loss: 1.50400, top1: 0.32493, top5: 1.00000, batch_cost: 4.81939s, reader_cost: 0.00022, ips: 53.11880 images/sec, eta: 0:15:54
    [2021/08/13 18:05:05] root INFO: [Train][Epoch 5/20][Avg]CELoss: 1.50387, loss: 1.50387, top1: 0.32296, top5: 1.00000
    [2021/08/13 18:05:08] root INFO: [Eval][Epoch 5][Iter: 0/6]CELoss: 1.44655, loss: 1.44655, top1: 0.32812, top5: 1.00000, batch_cost: 2.83252s, reader_cost: 1.88218, ips: 22.59470 images/sec
    [2021/08/13 18:05:10] root INFO: [Eval][Epoch 5][Avg]CELoss: 1.51563, loss: 1.51563, top1: 0.31143, top5: 1.00000
    [2021/08/13 18:05:10] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:05:10] root INFO: [Eval][Epoch 5][best metric: 0.3114285724503653]
    [2021/08/13 18:05:10] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_5
    [2021/08/13 18:05:10] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:05:26] root INFO: [Train][Epoch 6/20][Iter: 0/13]lr: 0.01250, CELoss: 1.47490, loss: 1.47490, top1: 0.32031, top5: 1.00000, batch_cost: 6.18732s, reader_cost: 0.97494, ips: 41.37496 images/sec, eta: 0:20:06
    [2021/08/13 18:05:32] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:06:14] root INFO: [Train][Epoch 6/20][Iter: 10/13]lr: 0.01244, CELoss: 1.46233, loss: 1.46233, top1: 0.35050, top5: 1.00000, batch_cost: 4.81019s, reader_cost: 0.00020, ips: 53.22033 images/sec, eta: 0:14:49
    [2021/08/13 18:06:21] root INFO: [Train][Epoch 6/20][Avg]CELoss: 1.46175, loss: 1.46175, top1: 0.34963, top5: 1.00000
    [2021/08/13 18:06:24] root INFO: [Eval][Epoch 6][Iter: 0/6]CELoss: 1.41299, loss: 1.41299, top1: 0.34375, top5: 1.00000, batch_cost: 2.97042s, reader_cost: 1.97225, ips: 21.54575 images/sec
    [2021/08/13 18:06:26] root INFO: [Eval][Epoch 6][Avg]CELoss: 1.47220, loss: 1.47220, top1: 0.34571, top5: 1.00000
    [2021/08/13 18:06:26] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:06:26] root INFO: [Eval][Epoch 6][best metric: 0.3457142862251827]
    [2021/08/13 18:06:26] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_6
    [2021/08/13 18:06:26] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:06:30] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:06:42] root INFO: [Train][Epoch 7/20][Iter: 0/13]lr: 0.01241, CELoss: 1.42246, loss: 1.42246, top1: 0.32812, top5: 1.00000, batch_cost: 6.26260s, reader_cost: 1.25620, ips: 40.87756 images/sec, eta: 0:18:59
    [2021/08/13 18:07:30] root INFO: [Train][Epoch 7/20][Iter: 10/13]lr: 0.01224, CELoss: 1.42728, loss: 1.42728, top1: 0.37074, top5: 1.00000, batch_cost: 4.77480s, reader_cost: 0.00018, ips: 53.61482 images/sec, eta: 0:13:41
    [2021/08/13 18:07:36] root INFO: [Train][Epoch 7/20][Avg]CELoss: 1.42122, loss: 1.42122, top1: 0.37345, top5: 1.00000
    [2021/08/13 18:07:39] root INFO: [Eval][Epoch 7][Iter: 0/6]CELoss: 1.35564, loss: 1.35564, top1: 0.40625, top5: 1.00000, batch_cost: 3.10716s, reader_cost: 2.07161, ips: 20.59760 images/sec
    [2021/08/13 18:07:41] root INFO: [Eval][Epoch 7][Avg]CELoss: 1.41530, loss: 1.41530, top1: 0.39143, top5: 1.00000
    [2021/08/13 18:07:41] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:07:41] root INFO: [Eval][Epoch 7][best metric: 0.3914285719394684]
    [2021/08/13 18:07:41] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_7
    [2021/08/13 18:07:41] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:07:43] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:07:57] root INFO: [Train][Epoch 8/20][Iter: 0/13]lr: 0.01217, CELoss: 1.39024, loss: 1.39024, top1: 0.41797, top5: 1.00000, batch_cost: 6.21345s, reader_cost: 1.19837, ips: 41.20093 images/sec, eta: 0:17:30
    [2021/08/13 18:08:45] root INFO: [Train][Epoch 8/20][Iter: 10/13]lr: 0.01189, CELoss: 1.40236, loss: 1.40236, top1: 0.37678, top5: 1.00000, batch_cost: 4.78099s, reader_cost: 0.00018, ips: 53.54540 images/sec, eta: 0:12:40
    [2021/08/13 18:08:52] root INFO: [Train][Epoch 8/20][Avg]CELoss: 1.39906, loss: 1.39906, top1: 0.37917, top5: 1.00000
    [2021/08/13 18:08:54] root INFO: [Eval][Epoch 8][Iter: 0/6]CELoss: 1.26315, loss: 1.26315, top1: 0.46875, top5: 1.00000, batch_cost: 2.81419s, reader_cost: 1.61652, ips: 22.74186 images/sec
    [2021/08/13 18:08:56] root INFO: [Eval][Epoch 8][Avg]CELoss: 1.36913, loss: 1.36913, top1: 0.43429, top5: 1.00000
    [2021/08/13 18:08:56] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:08:56] root INFO: [Eval][Epoch 8][best metric: 0.43428571445601327]
    [2021/08/13 18:08:56] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_8
    [2021/08/13 18:08:56] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:09:00] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:09:12] root INFO: [Train][Epoch 9/20][Iter: 0/13]lr: 0.01178, CELoss: 1.34695, loss: 1.34695, top1: 0.41016, top5: 1.00000, batch_cost: 6.20253s, reader_cost: 1.23426, ips: 41.27349 images/sec, eta: 0:16:07
    [2021/08/13 18:10:00] root INFO: [Train][Epoch 9/20][Iter: 10/13]lr: 0.01139, CELoss: 1.33926, loss: 1.33926, top1: 0.43714, top5: 1.00000, batch_cost: 4.79295s, reader_cost: 0.00018, ips: 53.41175 images/sec, eta: 0:11:39
    [2021/08/13 18:10:07] root INFO: [Train][Epoch 9/20][Avg]CELoss: 1.34682, loss: 1.34682, top1: 0.43569, top5: 1.00000
    [2021/08/13 18:10:10] root INFO: [Eval][Epoch 9][Iter: 0/6]CELoss: 1.19087, loss: 1.19087, top1: 0.53125, top5: 1.00000, batch_cost: 2.90136s, reader_cost: 1.90936, ips: 22.05862 images/sec
    [2021/08/13 18:10:12] root INFO: [Eval][Epoch 9][Avg]CELoss: 1.28619, loss: 1.28619, top1: 0.46286, top5: 1.00000
    [2021/08/13 18:10:12] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:10:12] root INFO: [Eval][Epoch 9][best metric: 0.4628571435383388]
    [2021/08/13 18:10:12] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_9
    [2021/08/13 18:10:12] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:10:13] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:10:27] root INFO: [Train][Epoch 10/20][Iter: 0/13]lr: 0.01126, CELoss: 1.34065, loss: 1.34065, top1: 0.40234, top5: 1.00000, batch_cost: 6.21695s, reader_cost: 1.24337, ips: 41.17777 images/sec, eta: 0:14:49
    [2021/08/13 18:11:16] root INFO: [Train][Epoch 10/20][Iter: 10/13]lr: 0.01077, CELoss: 1.25657, loss: 1.25657, top1: 0.46236, top5: 1.00000, batch_cost: 4.80385s, reader_cost: 0.00018, ips: 53.29063 images/sec, eta: 0:10:38
    [2021/08/13 18:11:22] root INFO: [Train][Epoch 10/20][Avg]CELoss: 1.25974, loss: 1.25974, top1: 0.46300, top5: 1.00000
    [2021/08/13 18:11:25] root INFO: [Eval][Epoch 10][Iter: 0/6]CELoss: 1.10561, loss: 1.10561, top1: 0.62500, top5: 1.00000, batch_cost: 2.93488s, reader_cost: 1.93176, ips: 21.80667 images/sec
    [2021/08/13 18:11:27] root INFO: [Eval][Epoch 10][Avg]CELoss: 1.24784, loss: 1.24784, top1: 0.48857, top5: 1.00000
    [2021/08/13 18:11:27] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:11:27] root INFO: [Eval][Epoch 10][best metric: 0.48857142925262453]
    [2021/08/13 18:11:27] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_10
    [2021/08/13 18:11:27] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:11:28] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:11:43] root INFO: [Train][Epoch 11/20][Iter: 0/13]lr: 0.01062, CELoss: 1.27339, loss: 1.27339, top1: 0.50781, top5: 1.00000, batch_cost: 6.23180s, reader_cost: 1.06107, ips: 41.07961 images/sec, eta: 0:13:30
    [2021/08/13 18:12:31] root INFO: [Train][Epoch 11/20][Iter: 10/13]lr: 0.01004, CELoss: 1.23732, loss: 1.23732, top1: 0.50000, top5: 1.00000, batch_cost: 4.80230s, reader_cost: 0.00019, ips: 53.30782 images/sec, eta: 0:09:36
    [2021/08/13 18:12:38] root INFO: [Train][Epoch 11/20][Avg]CELoss: 1.23297, loss: 1.23297, top1: 0.50079, top5: 1.00000
    [2021/08/13 18:12:41] root INFO: [Eval][Epoch 11][Iter: 0/6]CELoss: 1.02550, loss: 1.02550, top1: 0.70312, top5: 1.00000, batch_cost: 2.96888s, reader_cost: 1.96307, ips: 21.55695 images/sec
    [2021/08/13 18:12:43] root INFO: [Eval][Epoch 11][Avg]CELoss: 1.16352, loss: 1.16352, top1: 0.53143, top5: 1.00000
    [2021/08/13 18:12:43] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:12:43] root INFO: [Eval][Epoch 11][best metric: 0.5314285719394684]
    [2021/08/13 18:12:43] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_11
    [2021/08/13 18:12:43] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:12:58] root INFO: [Train][Epoch 12/20][Iter: 0/13]lr: 0.00986, CELoss: 1.18303, loss: 1.18303, top1: 0.51562, top5: 1.00000, batch_cost: 6.22979s, reader_cost: 1.01017, ips: 41.09286 images/sec, eta: 0:12:08
    [2021/08/13 18:13:09] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:13:47] root INFO: [Train][Epoch 12/20][Iter: 10/13]lr: 0.00922, CELoss: 1.20617, loss: 1.20617, top1: 0.50675, top5: 1.00000, batch_cost: 4.81314s, reader_cost: 0.00020, ips: 53.18772 images/sec, eta: 0:08:35
    [2021/08/13 18:13:53] root INFO: [Train][Epoch 12/20][Avg]CELoss: 1.20367, loss: 1.20367, top1: 0.50873, top5: 1.00000
    [2021/08/13 18:13:56] root INFO: [Eval][Epoch 12][Iter: 0/6]CELoss: 1.10325, loss: 1.10325, top1: 0.54688, top5: 1.00000, batch_cost: 2.76432s, reader_cost: 1.65534, ips: 23.15221 images/sec
    [2021/08/13 18:13:58] root INFO: [Eval][Epoch 12][Avg]CELoss: 1.19052, loss: 1.19052, top1: 0.51429, top5: 1.00000
    [2021/08/13 18:13:58] root INFO: [Eval][Epoch 12][best metric: 0.5314285719394684]
    [2021/08/13 18:13:58] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_12
    [2021/08/13 18:13:58] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:14:02] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:14:14] root INFO: [Train][Epoch 13/20][Iter: 0/13]lr: 0.00902, CELoss: 1.14904, loss: 1.14904, top1: 0.50781, top5: 1.00000, batch_cost: 6.22454s, reader_cost: 0.98921, ips: 41.12753 images/sec, eta: 0:10:47
    [2021/08/13 18:15:02] root INFO: [Train][Epoch 13/20][Iter: 10/13]lr: 0.00832, CELoss: 1.17008, loss: 1.17008, top1: 0.52663, top5: 1.00000, batch_cost: 4.78886s, reader_cost: 0.00018, ips: 53.45738 images/sec, eta: 0:07:30
    [2021/08/13 18:15:09] root INFO: [Train][Epoch 13/20][Avg]CELoss: 1.17405, loss: 1.17405, top1: 0.52652, top5: 1.00000
    [2021/08/13 18:15:12] root INFO: [Eval][Epoch 13][Iter: 0/6]CELoss: 1.03164, loss: 1.03164, top1: 0.64062, top5: 1.00000, batch_cost: 2.88432s, reader_cost: 1.94717, ips: 22.18895 images/sec
    [2021/08/13 18:15:13] root INFO: [Eval][Epoch 13][Avg]CELoss: 1.13726, loss: 1.13726, top1: 0.53429, top5: 1.00000
    [2021/08/13 18:15:13] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:15:13] root INFO: [Eval][Epoch 13][best metric: 0.5342857142857143]
    [2021/08/13 18:15:13] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_13
    [2021/08/13 18:15:13] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:15:20] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:15:29] root INFO: [Train][Epoch 14/20][Iter: 0/13]lr: 0.00811, CELoss: 1.13175, loss: 1.13175, top1: 0.55469, top5: 1.00000, batch_cost: 6.22249s, reader_cost: 1.24619, ips: 41.14108 images/sec, eta: 0:09:26
    [2021/08/13 18:16:18] root INFO: [Train][Epoch 14/20][Iter: 10/13]lr: 0.00738, CELoss: 1.15472, loss: 1.15472, top1: 0.52983, top5: 1.00000, batch_cost: 4.79891s, reader_cost: 0.00019, ips: 53.34543 images/sec, eta: 0:06:28
    [2021/08/13 18:16:24] root INFO: [Train][Epoch 14/20][Avg]CELoss: 1.15042, loss: 1.15042, top1: 0.53064, top5: 1.00000
    [2021/08/13 18:16:27] root INFO: [Eval][Epoch 14][Iter: 0/6]CELoss: 1.10114, loss: 1.10114, top1: 0.57812, top5: 1.00000, batch_cost: 2.81808s, reader_cost: 1.67274, ips: 22.71054 images/sec
    [2021/08/13 18:16:29] root INFO: [Eval][Epoch 14][Avg]CELoss: 1.13692, loss: 1.13692, top1: 0.54857, top5: 1.00000
    [2021/08/13 18:16:29] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:16:29] root INFO: [Eval][Epoch 14][best metric: 0.5485714306150163]
    [2021/08/13 18:16:29] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_14
    [2021/08/13 18:16:29] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:16:31] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:16:45] root INFO: [Train][Epoch 15/20][Iter: 0/13]lr: 0.00715, CELoss: 1.20706, loss: 1.20706, top1: 0.48828, top5: 1.00000, batch_cost: 6.22219s, reader_cost: 1.23796, ips: 41.14306 images/sec, eta: 0:08:05
    [2021/08/13 18:17:33] root INFO: [Train][Epoch 15/20][Iter: 10/13]lr: 0.00640, CELoss: 1.11772, loss: 1.11772, top1: 0.55256, top5: 1.00000, batch_cost: 4.75891s, reader_cost: 0.00021, ips: 53.79381 images/sec, eta: 0:05:23
    [2021/08/13 18:17:39] root INFO: [Train][Epoch 15/20][Avg]CELoss: 1.11187, loss: 1.11187, top1: 0.55446, top5: 1.00000
    [2021/08/13 18:17:42] root INFO: [Eval][Epoch 15][Iter: 0/6]CELoss: 1.04319, loss: 1.04319, top1: 0.53125, top5: 1.00000, batch_cost: 2.95261s, reader_cost: 1.94968, ips: 21.67572 images/sec
    [2021/08/13 18:17:44] root INFO: [Eval][Epoch 15][Avg]CELoss: 1.11115, loss: 1.11115, top1: 0.52571, top5: 1.00000
    [2021/08/13 18:17:44] root INFO: [Eval][Epoch 15][best metric: 0.5485714306150163]
    [2021/08/13 18:17:44] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_15
    [2021/08/13 18:17:44] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:17:51] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:18:00] root INFO: [Train][Epoch 16/20][Iter: 0/13]lr: 0.00617, CELoss: 1.06478, loss: 1.06478, top1: 0.61328, top5: 1.00000, batch_cost: 6.19106s, reader_cost: 1.10611, ips: 41.34993 images/sec, eta: 0:06:42
    [2021/08/13 18:18:48] root INFO: [Train][Epoch 16/20][Iter: 10/13]lr: 0.00542, CELoss: 1.09806, loss: 1.09806, top1: 0.56428, top5: 1.00000, batch_cost: 4.81586s, reader_cost: 0.00020, ips: 53.15771 images/sec, eta: 0:04:24
    [2021/08/13 18:18:55] root INFO: [Train][Epoch 16/20][Avg]CELoss: 1.09882, loss: 1.09882, top1: 0.56335, top5: 1.00000
    [2021/08/13 18:18:58] root INFO: [Eval][Epoch 16][Iter: 0/6]CELoss: 0.97295, loss: 0.97295, top1: 0.65625, top5: 1.00000, batch_cost: 2.89386s, reader_cost: 1.90739, ips: 22.11575 images/sec
    [2021/08/13 18:19:00] root INFO: [Eval][Epoch 16][Avg]CELoss: 1.09525, loss: 1.09525, top1: 0.55429, top5: 1.00000
    [2021/08/13 18:19:00] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:19:00] root INFO: [Eval][Epoch 16][best metric: 0.5542857142857143]
    [2021/08/13 18:19:00] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_16
    [2021/08/13 18:19:00] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:19:04] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:19:16] root INFO: [Train][Epoch 17/20][Iter: 0/13]lr: 0.00520, CELoss: 1.19868, loss: 1.19868, top1: 0.49219, top5: 1.00000, batch_cost: 6.25285s, reader_cost: 1.24810, ips: 40.94133 images/sec, eta: 0:05:25
    [2021/08/13 18:20:04] root INFO: [Train][Epoch 17/20][Iter: 10/13]lr: 0.00446, CELoss: 1.06798, loss: 1.06798, top1: 0.56214, top5: 1.00000, batch_cost: 4.80993s, reader_cost: 0.00019, ips: 53.22328 images/sec, eta: 0:03:22
    [2021/08/13 18:20:11] root INFO: [Train][Epoch 17/20][Avg]CELoss: 1.07631, loss: 1.07631, top1: 0.55764, top5: 1.00000
    [2021/08/13 18:20:14] root INFO: [Eval][Epoch 17][Iter: 0/6]CELoss: 0.90529, loss: 0.90529, top1: 0.70312, top5: 1.00000, batch_cost: 2.91065s, reader_cost: 1.92708, ips: 21.98820 images/sec
    [2021/08/13 18:20:16] root INFO: [Eval][Epoch 17][Avg]CELoss: 1.04229, loss: 1.04229, top1: 0.58571, top5: 1.00000
    [2021/08/13 18:20:16] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:20:16] root INFO: [Eval][Epoch 17][best metric: 0.5857142853736877]
    [2021/08/13 18:20:16] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_17
    [2021/08/13 18:20:16] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:20:17] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:20:32] root INFO: [Train][Epoch 18/20][Iter: 0/13]lr: 0.00425, CELoss: 1.07504, loss: 1.07504, top1: 0.54297, top5: 1.00000, batch_cost: 6.25388s, reader_cost: 1.25798, ips: 40.93461 images/sec, eta: 0:04:03
    [2021/08/13 18:21:20] root INFO: [Train][Epoch 18/20][Iter: 10/13]lr: 0.00355, CELoss: 1.05281, loss: 1.05281, top1: 0.57457, top5: 1.00000, batch_cost: 4.81270s, reader_cost: 0.00020, ips: 53.19258 images/sec, eta: 0:02:19
    [2021/08/13 18:21:27] root INFO: [Train][Epoch 18/20][Avg]CELoss: 1.05702, loss: 1.05702, top1: 0.57606, top5: 1.00000
    [2021/08/13 18:21:30] root INFO: [Eval][Epoch 18][Iter: 0/6]CELoss: 0.93162, loss: 0.93162, top1: 0.70312, top5: 1.00000, batch_cost: 2.87067s, reader_cost: 1.80553, ips: 22.29446 images/sec
    [2021/08/13 18:21:31] root INFO: [Eval][Epoch 18][Avg]CELoss: 1.04586, loss: 1.04586, top1: 0.57714, top5: 1.00000
    [2021/08/13 18:21:31] root INFO: [Eval][Epoch 18][best metric: 0.5857142853736877]
    [2021/08/13 18:21:31] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_18
    [2021/08/13 18:21:31] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:21:36] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:21:47] root INFO: [Train][Epoch 19/20][Iter: 0/13]lr: 0.00335, CELoss: 1.15695, loss: 1.15695, top1: 0.52734, top5: 1.00000, batch_cost: 6.20883s, reader_cost: 1.06027, ips: 41.23158 images/sec, eta: 0:02:41
    [2021/08/13 18:22:35] root INFO: [Train][Epoch 19/20][Iter: 10/13]lr: 0.00270, CELoss: 1.07053, loss: 1.07053, top1: 0.58132, top5: 1.00000, batch_cost: 4.76619s, reader_cost: 0.00019, ips: 53.71163 images/sec, eta: 0:01:16
    [2021/08/13 18:22:42] root INFO: [Train][Epoch 19/20][Avg]CELoss: 1.07094, loss: 1.07094, top1: 0.58018, top5: 1.00000
    [2021/08/13 18:22:45] root INFO: [Eval][Epoch 19][Iter: 0/6]CELoss: 0.90698, loss: 0.90698, top1: 0.70312, top5: 1.00000, batch_cost: 2.83807s, reader_cost: 1.70600, ips: 22.55054 images/sec
    [2021/08/13 18:22:46] root INFO: [Eval][Epoch 19][Avg]CELoss: 1.02589, loss: 1.02589, top1: 0.60286, top5: 1.00000
    [2021/08/13 18:22:46] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:22:46] root INFO: [Eval][Epoch 19][best metric: 0.6028571449007307]
    [2021/08/13 18:22:46] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_19
    [2021/08/13 18:22:46] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest
    [2021/08/13 18:22:50] root ERROR: Exception occured when parse line: ./dataset/scenes/.DS_Store with msg: 'NoneType' object has no attribute 'shape'
    [2021/08/13 18:23:02] root INFO: [Train][Epoch 20/20][Iter: 0/13]lr: 0.00252, CELoss: 1.00926, loss: 1.00926, top1: 0.57812, top5: 1.00000, batch_cost: 6.18408s, reader_cost: 1.13440, ips: 41.39663 images/sec, eta: 0:01:20
    [2021/08/13 18:23:51] root INFO: [Train][Epoch 20/20][Iter: 10/13]lr: 0.00194, CELoss: 1.03935, loss: 1.03935, top1: 0.58381, top5: 1.00000, batch_cost: 4.80851s, reader_cost: 0.00021, ips: 53.23892 images/sec, eta: 0:00:14
    [2021/08/13 18:23:57] root INFO: [Train][Epoch 20/20][Avg]CELoss: 1.04118, loss: 1.04118, top1: 0.58368, top5: 1.00000
    [2021/08/13 18:24:00] root INFO: [Eval][Epoch 20][Iter: 0/6]CELoss: 0.89994, loss: 0.89994, top1: 0.64062, top5: 1.00000, batch_cost: 2.84710s, reader_cost: 1.89593, ips: 22.47899 images/sec
    [2021/08/13 18:24:02] root INFO: [Eval][Epoch 20][Avg]CELoss: 1.01491, loss: 1.01491, top1: 0.59143, top5: 1.00000
    [2021/08/13 18:24:02] root INFO: [Eval][Epoch 20][best metric: 0.6028571449007307]
    [2021/08/13 18:24:02] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/epoch_20
    [2021/08/13 18:24:02] root INFO: Already save model in ./output/ShuffleNetV2_x0_25/latest


### 3.3 é¢„æµ‹ä¸€å¼ 


```python
# æ›´æ¢ä¸ºä½ è®­ç»ƒçš„ç½‘ç»œï¼Œéœ€è¦é¢„æµ‹çš„æ–‡ä»¶ï¼Œä¸Šé¢è®­ç»ƒæ‰€å¾—åˆ°çš„çš„æœ€ä¼˜æ¨¡å‹æ–‡ä»¶
# æˆ‘è¿™é‡Œæ˜¯ä¸ä¸¥è°¨çš„ï¼Œç›´æ¥ä½¿ç”¨è®­ç»ƒé›†çš„å›¾ç‰‡è¿›è¡ŒéªŒè¯ï¼Œå¤§å®¶å¯ä»¥å»ç™¾åº¦æœä¸€äº›ç›¸å…³çš„å›¾ç‰‡ä¼ ä¸Šæ¥ï¼Œè¿›è¡Œé¢„æµ‹
!python3 tools/infer.py \
    -c ./ppcls/configs/quick_start/new_user/ShuffleNetV2_x0_25.yaml \
    -o Infer.infer_imgs=dataset/1.jpg \
    -o Global.pretrained_model=output/ShuffleNetV2_x0_25/best_model
```

    /home/aistudio/PaddleClas/ppcls/arch/backbone/model_zoo/vision_transformer.py:15: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Callable
    [2021/08/13 18:26:29] root INFO: 
    ===========================================================
    ==        PaddleClas is powered by PaddlePaddle !        ==
    ===========================================================
    ==                                                       ==
    ==   For more info please go to the following website.   ==
    ==                                                       ==
    ==       https://github.com/PaddlePaddle/PaddleClas      ==
    ===========================================================
    
    [2021/08/13 18:26:29] root INFO: Arch : 
    [2021/08/13 18:26:29] root INFO:     class_num : 102
    [2021/08/13 18:26:29] root INFO:     name : ShuffleNetV2_x0_25
    [2021/08/13 18:26:29] root INFO: DataLoader : 
    [2021/08/13 18:26:29] root INFO:     Eval : 
    [2021/08/13 18:26:29] root INFO:         dataset : 
    [2021/08/13 18:26:29] root INFO:             cls_label_path : ./dataset/scenes/val_list.txt
    [2021/08/13 18:26:29] root INFO:             image_root : ./dataset/
    [2021/08/13 18:26:29] root INFO:             name : ImageNetDataset
    [2021/08/13 18:26:29] root INFO:             transform_ops : 
    [2021/08/13 18:26:29] root INFO:                 DecodeImage : 
    [2021/08/13 18:26:29] root INFO:                     channel_first : False
    [2021/08/13 18:26:29] root INFO:                     to_rgb : True
    [2021/08/13 18:26:29] root INFO:                 ResizeImage : 
    [2021/08/13 18:26:29] root INFO:                     resize_short : 256
    [2021/08/13 18:26:29] root INFO:                 CropImage : 
    [2021/08/13 18:26:29] root INFO:                     size : 224
    [2021/08/13 18:26:29] root INFO:                 NormalizeImage : 
    [2021/08/13 18:26:29] root INFO:                     mean : [0.485, 0.456, 0.406]
    [2021/08/13 18:26:29] root INFO:                     order : 
    [2021/08/13 18:26:29] root INFO:                     scale : 1.0/255.0
    [2021/08/13 18:26:29] root INFO:                     std : [0.229, 0.224, 0.225]
    [2021/08/13 18:26:29] root INFO:         loader : 
    [2021/08/13 18:26:29] root INFO:             num_workers : 4
    [2021/08/13 18:26:29] root INFO:             use_shared_memory : False
    [2021/08/13 18:26:29] root INFO:         sampler : 
    [2021/08/13 18:26:29] root INFO:             batch_size : 64
    [2021/08/13 18:26:29] root INFO:             drop_last : False
    [2021/08/13 18:26:29] root INFO:             name : DistributedBatchSampler
    [2021/08/13 18:26:29] root INFO:             shuffle : False
    [2021/08/13 18:26:29] root INFO:     Train : 
    [2021/08/13 18:26:29] root INFO:         dataset : 
    [2021/08/13 18:26:29] root INFO:             cls_label_path : ./dataset/scenes/train_list.txt
    [2021/08/13 18:26:29] root INFO:             image_root : ./dataset/
    [2021/08/13 18:26:29] root INFO:             name : ImageNetDataset
    [2021/08/13 18:26:29] root INFO:             transform_ops : 
    [2021/08/13 18:26:29] root INFO:                 DecodeImage : 
    [2021/08/13 18:26:29] root INFO:                     channel_first : False
    [2021/08/13 18:26:29] root INFO:                     to_rgb : True
    [2021/08/13 18:26:29] root INFO:                 RandCropImage : 
    [2021/08/13 18:26:29] root INFO:                     size : 224
    [2021/08/13 18:26:29] root INFO:                 RandFlipImage : 
    [2021/08/13 18:26:29] root INFO:                     flip_code : 1
    [2021/08/13 18:26:29] root INFO:                 NormalizeImage : 
    [2021/08/13 18:26:29] root INFO:                     mean : [0.485, 0.456, 0.406]
    [2021/08/13 18:26:29] root INFO:                     order : 
    [2021/08/13 18:26:29] root INFO:                     scale : 1.0/255.0
    [2021/08/13 18:26:29] root INFO:                     std : [0.229, 0.224, 0.225]
    [2021/08/13 18:26:29] root INFO:         loader : 
    [2021/08/13 18:26:29] root INFO:             num_workers : 4
    [2021/08/13 18:26:29] root INFO:             use_shared_memory : False
    [2021/08/13 18:26:29] root INFO:         sampler : 
    [2021/08/13 18:26:29] root INFO:             batch_size : 256
    [2021/08/13 18:26:29] root INFO:             drop_last : False
    [2021/08/13 18:26:29] root INFO:             name : DistributedBatchSampler
    [2021/08/13 18:26:29] root INFO:             shuffle : True
    [2021/08/13 18:26:29] root INFO: Global : 
    [2021/08/13 18:26:29] root INFO:     checkpoints : None
    [2021/08/13 18:26:29] root INFO:     device : cpu
    [2021/08/13 18:26:29] root INFO:     epochs : 20
    [2021/08/13 18:26:29] root INFO:     eval_during_train : True
    [2021/08/13 18:26:29] root INFO:     eval_interval : 1
    [2021/08/13 18:26:29] root INFO:     image_shape : [3, 224, 224]
    [2021/08/13 18:26:29] root INFO:     output_dir : ./output/
    [2021/08/13 18:26:29] root INFO:     pretrained_model : output/ShuffleNetV2_x0_25/best_model
    [2021/08/13 18:26:29] root INFO:     print_batch_step : 10
    [2021/08/13 18:26:29] root INFO:     save_inference_dir : ./inference
    [2021/08/13 18:26:29] root INFO:     save_interval : 1
    [2021/08/13 18:26:29] root INFO:     use_visualdl : False
    [2021/08/13 18:26:29] root INFO: Infer : 
    [2021/08/13 18:26:29] root INFO:     PostProcess : 
    [2021/08/13 18:26:29] root INFO:         class_id_map_file : ./dataset/label_list.txt
    [2021/08/13 18:26:29] root INFO:         name : Topk
    [2021/08/13 18:26:29] root INFO:         topk : 5
    [2021/08/13 18:26:29] root INFO:     batch_size : 10
    [2021/08/13 18:26:29] root INFO:     infer_imgs : dataset/1.jpg
    [2021/08/13 18:26:29] root INFO:     transforms : 
    [2021/08/13 18:26:29] root INFO:         DecodeImage : 
    [2021/08/13 18:26:29] root INFO:             channel_first : False
    [2021/08/13 18:26:29] root INFO:             to_rgb : True
    [2021/08/13 18:26:29] root INFO:         ResizeImage : 
    [2021/08/13 18:26:29] root INFO:             resize_short : 256
    [2021/08/13 18:26:29] root INFO:         CropImage : 
    [2021/08/13 18:26:29] root INFO:             size : 224
    [2021/08/13 18:26:29] root INFO:         NormalizeImage : 
    [2021/08/13 18:26:29] root INFO:             mean : [0.485, 0.456, 0.406]
    [2021/08/13 18:26:29] root INFO:             order : 
    [2021/08/13 18:26:29] root INFO:             scale : 1.0/255.0
    [2021/08/13 18:26:29] root INFO:             std : [0.229, 0.224, 0.225]
    [2021/08/13 18:26:29] root INFO:         ToCHWImage : None
    [2021/08/13 18:26:29] root INFO: Loss : 
    [2021/08/13 18:26:29] root INFO:     Eval : 
    [2021/08/13 18:26:29] root INFO:         CELoss : 
    [2021/08/13 18:26:29] root INFO:             weight : 1.0
    [2021/08/13 18:26:29] root INFO:     Train : 
    [2021/08/13 18:26:29] root INFO:         CELoss : 
    [2021/08/13 18:26:29] root INFO:             weight : 1.0
    [2021/08/13 18:26:29] root INFO: Metric : 
    [2021/08/13 18:26:29] root INFO:     Eval : 
    [2021/08/13 18:26:29] root INFO:         TopkAcc : 
    [2021/08/13 18:26:29] root INFO:             topk : [1, 5]
    [2021/08/13 18:26:29] root INFO:     Train : 
    [2021/08/13 18:26:29] root INFO:         TopkAcc : 
    [2021/08/13 18:26:29] root INFO:             topk : [1, 5]
    [2021/08/13 18:26:29] root INFO: Optimizer : 
    [2021/08/13 18:26:29] root INFO:     lr : 
    [2021/08/13 18:26:29] root INFO:         learning_rate : 0.0125
    [2021/08/13 18:26:29] root INFO:         name : Cosine
    [2021/08/13 18:26:29] root INFO:         warmup_epoch : 5
    [2021/08/13 18:26:29] root INFO:     momentum : 0.9
    [2021/08/13 18:26:29] root INFO:     name : Momentum
    [2021/08/13 18:26:29] root INFO:     regularizer : 
    [2021/08/13 18:26:29] root INFO:         coeff : 1e-05
    [2021/08/13 18:26:29] root INFO:         name : L2
    [2021/08/13 18:26:29] root INFO: train with paddle 2.1.2 and device CPUPlace
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:125: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      if data.dtype == np.object:
    [{'class_ids': [3, 1, 2, 4, 5], 'scores': [0.87053, 0.04778, 0.03573, 0.03035, 0.01497], 'file_name': 'dataset/1.jpg', 'label_names': ['desert', 'church', 'river', 'ice', 'lawn']}]


è¿è¡Œå®Œæˆï¼Œæœ€åå‡ è¡Œä¼šå¾—åˆ°ç»“æœå¦‚ä¸‹å½¢å¼ï¼š
```
[{'class_ids': [5, 1, 3, 4, 2],
'scores': [0.48433, 0.26765, 0.13903, 0.05609, 0.05162],
'file_name': 'dataset/foods/baby_back_ribs/319516.jpg', 
'label_names': ['baklava', 'beef_carpaccio', 'beef_tartare', 'apple_pie', 'baby_back_ribs']}]
```
å¯ä»¥å‘ç°ï¼Œé¢„æµ‹ç»“æœä¸å¯¹ï¼Œå‡†ç¡®ç‡å¾ˆä½ï¼Œä½†æ•´ä½“çš„é¡¹ç›®æµç¨‹ä½ å·²ç»æŒæ¡äº†ï¼    
è®­ç»ƒè½®æ•°è¿˜æœ‰å¾ˆå¤§æå‡ç©ºé—´ï¼Œè‡ªè¡Œå˜åŠ¨å‚æ•°ç›´åˆ°é¢„æµ‹æ­£ç¡®ä¸ºæ­¢~    

<font size="3px" color="red">æ­å–œä½ å­¦ä¼šäº†paddleclaså›¾åƒåˆ†ç±»ï¼</font>

## æœ€åï¼ˆï¼å¾ˆé‡è¦ï¼ï¼‰    
1. ç”Ÿæˆç‰ˆæœ¬     
![](https://ai-studio-static-online.cdn.bcebos.com/adda3ac3b96c403daa68f9f5ec9fd807930d1404f5834317a4f3d7e662243ebc)   
2. æœ‰èƒ½åŠ›è€…å¯¼å‡ºmarkdownå‘è¡¨åˆ°githubä¸Š      
![](https://ai-studio-static-online.cdn.bcebos.com/a1f8fdad7659463381d8857e9fd63e84648591fc1a264f1a8241029fb825fe78)      
3. å…¬å¼€é¡¹ç›®   
![](https://ai-studio-static-online.cdn.bcebos.com/bc8af42d84914b7a8e882e3b88551aa7a5943cf7351747b2b6df3310be53eb05)    
4. <font color="red">ç¥å¤§å®¶é¡ºåˆ©ç»“ä¸š~</font>
